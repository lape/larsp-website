<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://bridgetownrb.com/" version="1.3.4">Bridgetown</generator><link href="https://larsp.de/feed.xml" rel="self" type="application/atom+xml" /><link href="https://larsp.de/" rel="alternate" type="text/html" /><updated>2024-10-19T09:47:40+02:00</updated><id>https://larsp.de/feed.xml</id><title type="html">larsp.de</title><subtitle>I&apos;m Lars, a software developer and IT consultant from Germany. This is my personal website, where I write about my journey as a full stack developer and take notes on things I learned along the way.</subtitle><entry><title type="html">Favorite CLI Tools</title><link href="https://larsp.de/software/favorite-cli-tools/" rel="alternate" type="text/html" title="Favorite CLI Tools" /><published>2024-04-17T00:00:00+02:00</published><updated>2024-04-17T00:00:00+02:00</updated><id>repo://posts.collection/_posts/2024-04-17-favorite-cli-tools.md</id><content type="html" xml:base="https://larsp.de/software/favorite-cli-tools/">&lt;p&gt;In software development, the command line is the equivalent of a wizard’s staff. These CLI tools saved me heaps of time and I find them generally a joy to work with.&lt;/p&gt;

&lt;p&gt;It’s all about sharing the love and the magic, and maybe you’ll find a new favorite or two. Let me &lt;a href=&quot;/contact&quot;&gt;know&lt;/a&gt; if you have an invaluable CLI tool that you can’t live without.&lt;/p&gt;

&lt;h2 id=&quot;bat---a-cat1-clone-with-wings&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;bat&lt;/code&gt; - a cat(1) clone with wings&lt;/h2&gt;

&lt;p&gt;I love this. It’s a drop-in replacement for &lt;code class=&quot;highlighter-rouge&quot;&gt;cat&lt;/code&gt; that adds syntax highlighting, Git integration and lots more. It’s written in Rust and is blazing fast. &lt;a href=&quot;https://github.com/sharkdp/bat&quot;&gt;sharkdp/bat: A cat(1) clone with wings.&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;how-to-use-bat&quot;&gt;How to use &lt;code class=&quot;highlighter-rouge&quot;&gt;bat&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;To glance at a file using &lt;code class=&quot;highlighter-rouge&quot;&gt;bat&lt;/code&gt;, simply provide the path:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bat /path/to/your/file
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The syntax highlighting and file-specific metadata make &lt;code class=&quot;highlighter-rouge&quot;&gt;bat&lt;/code&gt; a joy to use, ensuring you can inspect code and text files efficiently and with finesse.&lt;/p&gt;

&lt;h2 id=&quot;homebrew---the-missing-package-manager-for-macos&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Homebrew&lt;/code&gt; - The missing package manager for macOS&lt;/h2&gt;

&lt;p&gt;It’s simply a must-have for every Mac user. Whether it’s installing a new programming language, a database server, or the latest web framework, &lt;code class=&quot;highlighter-rouge&quot;&gt;Homebrew&lt;/code&gt; streamlines the process, taking out the need for locating and manually downloading software.&lt;/p&gt;

&lt;h3 id=&quot;the-brew-command&quot;&gt;The brew command&lt;/h3&gt;

&lt;p&gt;Working with &lt;code class=&quot;highlighter-rouge&quot;&gt;Homebrew&lt;/code&gt; is straightforward:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;brew update
brew &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &amp;lt;package&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Homebrew&lt;/code&gt; also handles dependencies, ensuring that your software stack remains tidy and up-to-date with a simple command. Plus, with over 4,800 official packages and a thriving community of contributors, you’re sure to find everything you need.&lt;/p&gt;

&lt;h2 id=&quot;httpie---http-client-for-the-command-line&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;httpie&lt;/code&gt; - HTTP client for the command line&lt;/h2&gt;

&lt;p&gt;Making HTTP requests from the command line has never been more elegant than with &lt;code class=&quot;highlighter-rouge&quot;&gt;httpie&lt;/code&gt;. It simplifies interaction with APIs and web services, offering a user-friendly interface and an eye-pleasing HTTP request syntax colorization.&lt;/p&gt;

&lt;h3 id=&quot;crafting-requests-with-httpie&quot;&gt;Crafting requests with &lt;code class=&quot;highlighter-rouge&quot;&gt;httpie&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;A basic GET request:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;https httpie.io/hello
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;ahoy&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Hello, World! 👋 Thank you for trying out HTTPie 🥳&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;We hope this will become a friendship.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;links&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;discord&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;https://httpie.io/discord&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;github&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;https://github.com/httpie&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;homepage&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;https://httpie.io&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;twitter&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;https://twitter.com/httpie&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And the response is structured, formatted, and legible. &lt;code class=&quot;highlighter-rouge&quot;&gt;httpie&lt;/code&gt; also supports POST, PUT, DELETE requests, authentication, and other advanced features. It’s a great alternative to &lt;code class=&quot;highlighter-rouge&quot;&gt;curl&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&quot;jq---command-line-json-processor&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;jq&lt;/code&gt; - Command-line JSON processor&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;jq&lt;/code&gt; is a sed-like tool that parses, manipulates, and displays JSON objects from the comfort of the command line. It excels at selectively filtering and transforming complex JSON data, which is a common task when working with APIs and backend services.&lt;/p&gt;

&lt;h3 id=&quot;transforming-with-jq&quot;&gt;Transforming with &lt;code class=&quot;highlighter-rouge&quot;&gt;jq&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;Filtering results:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;https httpie.io/hello | jq &lt;span class=&quot;s2&quot;&gt;&quot;{links}&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This will present just the links from the JSON response. &lt;code class=&quot;highlighter-rouge&quot;&gt;jq&lt;/code&gt; is nice for quickly juggling JSON data.&lt;/p&gt;

&lt;h2 id=&quot;lando---local-development-environment-and-devops-tool-built-on-docker-containers&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;lando&lt;/code&gt; - Local development environment and DevOps tool built on Docker containers&lt;/h2&gt;

&lt;p&gt;For local development, &lt;code class=&quot;highlighter-rouge&quot;&gt;lando&lt;/code&gt; is a mighty ally. It configures and manages Docker-based development environments, providing an abstraction layer that spares developers the mundanity of configuring development Docker environments and installing necessary tools and software versions.&lt;/p&gt;

&lt;h3 id=&quot;a-lando-starter&quot;&gt;A &lt;code class=&quot;highlighter-rouge&quot;&gt;lando&lt;/code&gt; starter&lt;/h3&gt;

&lt;p&gt;Creating a Wordpress site:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;lando init &lt;span class=&quot;nt&quot;&gt;--recipe&lt;/span&gt; wordpress
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And with that simple command, you’re on your way to local Wordpress development with a containerized environment. &lt;code class=&quot;highlighter-rouge&quot;&gt;lando&lt;/code&gt; integrates with other tools such as &lt;code class=&quot;highlighter-rouge&quot;&gt;composer&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;npm&lt;/code&gt;, and &lt;code class=&quot;highlighter-rouge&quot;&gt;gulp&lt;/code&gt; to streamline development workflows. It’s an excellent tool for building, testing, and deploying applications locally.  One of the most powerful features is the ability to define multiple environments in a single configuration file (e.g. local, staging, production) that can be easily switched between.&lt;/p&gt;

&lt;h2 id=&quot;ohmyzsh---delightful-framework-for-managing-your-zsh-configuration&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ohmyzsh&lt;/code&gt; - Delightful framework for managing your &lt;code class=&quot;highlighter-rouge&quot;&gt;zsh&lt;/code&gt; configuration&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ohmyzsh&lt;/code&gt; transforms the already powerful &lt;code class=&quot;highlighter-rouge&quot;&gt;zsh&lt;/code&gt; into a feature-rich and stylish terminal environment. With themes, plugins, and an active community contributing enhancements, &lt;code class=&quot;highlighter-rouge&quot;&gt;ohmyzsh&lt;/code&gt; makes the terminal experience more personal and productive.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ohmyzsh&lt;/code&gt; also comes packed with a variety of plugins that add new features to &lt;code class=&quot;highlighter-rouge&quot;&gt;zsh&lt;/code&gt;, such as an auto-suggestion tool and syntax highlighting, making it even more powerful. These can be easily enabled or disabled through the &lt;code class=&quot;highlighter-rouge&quot;&gt;~/.zshrc&lt;/code&gt; file as well.&lt;/p&gt;

&lt;h2 id=&quot;rbenv---ruby-version-manager&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;rbenv&lt;/code&gt; - Ruby Version Manager&lt;/h2&gt;

&lt;p&gt;For managing multiple Ruby environments, &lt;code class=&quot;highlighter-rouge&quot;&gt;rbenv&lt;/code&gt; is a vital cog. It allows for per-project Ruby versions, which is a blessing when working on legacy software that demands older Ruby interpreters alongside the current releases.&lt;/p&gt;

&lt;h3 id=&quot;balancing-ruby-versions&quot;&gt;Balancing Ruby versions&lt;/h3&gt;

&lt;p&gt;Selecting a Ruby version for your project:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rbenv &lt;span class=&quot;nb&quot;&gt;local &lt;/span&gt;3.3.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This indicates that the local project should use Ruby 3.3.0, leaving others unaffected by the change. When executing &lt;code class=&quot;highlighter-rouge&quot;&gt;bundle&lt;/code&gt; command, or any other code that requires a Ruby environment, &lt;code class=&quot;highlighter-rouge&quot;&gt;rbenv&lt;/code&gt; will use the specified version. This keeps developers from experiencing surprises when their global Ruby version is updated, and your project breaks.&lt;/p&gt;

&lt;h2 id=&quot;zsh-autosuggestions---completions-for-zsh&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;zsh-autosuggestions&lt;/code&gt; - Completions for &lt;code class=&quot;highlighter-rouge&quot;&gt;zsh&lt;/code&gt;&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;zsh&lt;/code&gt; users will find &lt;code class=&quot;highlighter-rouge&quot;&gt;zsh-autosuggestions&lt;/code&gt; a game-changer. This tool offers context-aware auto-completion, predicting your command line needs with eerie accuracy, and saving precious keystrokes in the process.&lt;/p&gt;

&lt;p&gt;Simply start typing a command and, based on your history, &lt;code class=&quot;highlighter-rouge&quot;&gt;zsh-autosuggestions&lt;/code&gt; will begin offering predictions. You can cycle through suggestions with the right arrow key or accept one with the tab key.&lt;/p&gt;</content><author><name></name></author><category term="software" /></entry><entry><title type="html">Syncthing</title><link href="https://larsp.de/software/syncthing/" rel="alternate" type="text/html" title="Syncthing" /><published>2023-10-28T00:00:00+02:00</published><updated>2023-10-28T00:00:00+02:00</updated><id>repo://posts.collection/_posts/2023-10-28-syncthing.md</id><content type="html" xml:base="https://larsp.de/software/syncthing/">&lt;p&gt;As much I wanted it to work, iCloud file synchronization always gave me headaches. I work with two Macs - one Mini in the office, and a MacBook on the go. In addition, I’m using a large iPad Pro and an older, small iPad Pro for traveling. My work files, mostly Git repositories of projects I am working on and additional reference material, should be shared across all these devices. I tried to use iCloud for this, but it was always a pain to get it to work reliably. I also used Dropbox in the past, but moved away after they went the course of integration everything and whatnot in their software. Also, it was a resource hog.&lt;/p&gt;

&lt;p&gt;The problem with iCloud is that you don’t really know what’s going on. It’s a black box. You can’t see what’s happening, and you can’t really control it. When the service thinks your files might have been changed on another device, it will create a copy of the file with a suffix “ 2”. Sometimes this happens for hundreds of files in a folder, and I resorted to just deleting them with:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;find &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-name&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;*&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-delete&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Also, sometimes iCloud is not updating at all for some reason. Yesterday, I was fed up with this and installed &lt;a href=&quot;https://github.com/syncthing/syncthing&quot;&gt;Syncthing&lt;/a&gt; on my Macs. It’s a free, open-source file synchronization software that works on all major platforms and works really smoothly. I used it in the past already, and never had a problem. For iOS, there is a third party solution (&lt;a href=&quot;https://www.mobiussync.com/&quot;&gt;MöbiusSync&lt;/a&gt;) for syncing with you other devices (worked also without problems for me, in a minute).&lt;/p&gt;

&lt;p&gt;There is a &lt;a href=&quot;https://github.com/syncthing/syncthing/blob/main/GOALS.md&quot;&gt;goals document&lt;/a&gt; describing Syncthing if you’re interested.&lt;/p&gt;</content><author><name></name></author><category term="software" /></entry><entry><title type="html">Ghost CMS</title><link href="https://larsp.de/webtech/ghost-cms/" rel="alternate" type="text/html" title="Ghost CMS" /><published>2023-10-07T00:00:00+02:00</published><updated>2023-10-07T00:00:00+02:00</updated><id>repo://posts.collection/_posts/2023-10-07-ghost-cms.md</id><content type="html" xml:base="https://larsp.de/webtech/ghost-cms/">&lt;p&gt;&lt;a href=&quot;https://ghost.org/&quot;&gt;Ghost&lt;/a&gt; is a fantastic open-source, headless Node.js CMS and my go-to system for setting up content sites (e.g. my consulting business site &lt;a href=&quot;https://itpeters.com/&quot;&gt;itpeters.com&lt;/a&gt; or my private travel logbook &lt;a href=&quot;https://reisepedia.de/&quot;&gt;reisepedia.de&lt;/a&gt;). Essentially, it’s a customizable platform for running blogs, magazines, or journals. It’s fully &lt;a href=&quot;https://github.com/TryGhost/Ghost&quot;&gt;open-source&lt;/a&gt; and runs blogs including OpenAI, DigitalOcean, and Mozilla.&lt;/p&gt;

&lt;p&gt;The Ghost Foundation is offering a hosted version of Ghost, so it’s accessible for non-technical content creators. This is really great and should be used by all means, if you don’t want to deal with the technical aspects of running a web server. For me, however, it comes natural to set up a Ghost instance on my own server with the &lt;a href=&quot;https://hub.docker.com/_/ghost/&quot;&gt;offical Docker image&lt;/a&gt; and Dokku.&lt;/p&gt;

&lt;p&gt;There are also a ton of themes for purchase (and for free!) on Ghost’s official website. I personally like the themes from &lt;a href=&quot;https://brightthemes.com/&quot;&gt;Bright Themes&lt;/a&gt;, which are very well designed and easy to customize.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/ghost-admin.png&quot; alt=&quot;Ghost admin dashboard&quot; style=&quot;text-align:center; filter:drop-shadow(5px 5px 5px #aaa)&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Key features:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Very fast and stable&lt;/li&gt;
  &lt;li&gt;Open Source (MIT license)&lt;/li&gt;
  &lt;li&gt;Paid subscription and membership support&lt;/li&gt;
  &lt;li&gt;SEO and social media optimization&lt;/li&gt;
  &lt;li&gt;Newsletter integration&lt;/li&gt;
  &lt;li&gt;Native REST API in core&lt;/li&gt;
  &lt;li&gt;Admin dashboard&lt;/li&gt;
  &lt;li&gt;Hosted version available&lt;/li&gt;
  &lt;li&gt;Self-hosting possible and well-documented&lt;/li&gt;
  &lt;li&gt;Great themes available (paid and free)&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="webtech" /></entry><entry><title type="html">Barcode PDFs with Ruby on Rails</title><link href="https://larsp.de/rails/barcode-pdfs-with-ruby-on-rails/" rel="alternate" type="text/html" title="Barcode PDFs with Ruby on Rails" /><published>2023-08-09T00:00:00+02:00</published><updated>2023-08-09T00:00:00+02:00</updated><id>repo://posts.collection/_posts/2023-08-09-barcode-pdfs-with-ruby-on-rails.md</id><content type="html" xml:base="https://larsp.de/rails/barcode-pdfs-with-ruby-on-rails/">&lt;p&gt;For a project, I was researching methods to generate individual PDFs with imprinted EAN barcodes. Some of the how-tos and blog articles I found were quite old, and it was not always immediately obvious if the solution still works and could be recommended in 2023. The following represents my short notes of a working way to do this. There may be other or better ways, but this one worked for me.&lt;/p&gt;

&lt;p&gt;Barby is a barcode generator library for Ruby. It generates a barcode as an image or as a PDF. For creating the actual PDF with background image I am using the Prawn PDF generation library for Ruby. It produces PDFs from scratch and annotates existing PDFs with text, images, and barcodes.&lt;/p&gt;

&lt;p&gt;I am using two model classes, one for the voucher with the &lt;em&gt;code&lt;/em&gt; property (which shall be printed as a barcode), and one for the PDF generation. The PDF generation class is a subclass of &lt;em&gt;Prawn::Document&lt;/em&gt;. It takes a path and a code as arguments and generates a PDF with the barcode imprinted. The voucher class creates a temporary file, calls the PDF generation class, and returns the path to the temporary file. As we are using Rails &lt;em&gt;Tempfile&lt;/em&gt;, the temporary file is deleted automatically when the Rails process exits.&lt;/p&gt;

&lt;p&gt;The resulting PDF should be 100mm x 133mm with a png as the background image. At first, I experimented with the &lt;em&gt;background&lt;/em&gt; option of &lt;em&gt;Prawn::Document&lt;/em&gt;, but this did not work as expected. The background image didn’t scale to the page size. Instead, I am using the &lt;em&gt;image&lt;/em&gt; method to draw the background image. The &lt;em&gt;fit&lt;/em&gt; option scales the image to the page size.&lt;/p&gt;

&lt;p&gt;Prawn’s measurement_extensions allow the use of mm as a unit for the page size instead of the default 1/72 inch.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;barby/barcode/code_128&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;barby/outputter/prawn_outputter&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;prawn/measurement_extensions&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CodePdf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Prawn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Document&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initialize&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;background&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
      &lt;span class=&quot;ss&quot;&gt;page_size: &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;mm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;177&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;mm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
      &lt;span class=&quot;ss&quot;&gt;margin: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;background&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;fit: &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;mm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;177&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;mm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;barcode&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;render_file&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;barcode&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;barcode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Barby&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Code128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;barcode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;annotate_pdf&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;height: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;mm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;x: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;mm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;y: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;mm&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the &lt;em&gt;code&lt;/em&gt; class, we create a temporary file and call the PDF generation class. The background image is found in the &lt;em&gt;app/assets/images/{language}&lt;/em&gt; directory. The name of the background image is stored in the &lt;em&gt;voucher&lt;/em&gt; property of the &lt;em&gt;price&lt;/em&gt; object (where the &lt;em&gt;code&lt;/em&gt; belongs_to). The &lt;em&gt;voucher&lt;/em&gt; property is a string like &lt;em&gt;voucher.png&lt;/em&gt;. The &lt;em&gt;I18n.locale&lt;/em&gt; method returns the current locale, e.g. &lt;em&gt;de&lt;/em&gt; or &lt;em&gt;fr&lt;/em&gt; which is used to find the correct background image.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;voucher&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Create temporary file e.g. tmp/voucher20230805-66997-kozjms.pdf&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;tmpfile&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Tempfile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;voucher&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Rails&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;tmp&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmpfile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;.pdf&quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;bg_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Rails&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;join&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;app&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;assets&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;images&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;I18n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;locale&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;price&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;voucher&lt;/span&gt;
  &lt;span class=&quot;no&quot;&gt;CodePdf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bg_path&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here is an example of the resulting voucher PDF with the barcode:&lt;/p&gt;

&lt;p style=&quot;text-align:center; filter:drop-shadow(5px 5px 5px #aaa)&quot;&gt;&lt;img src=&quot;/images/voucherpdf.png&quot; alt=&quot;Voucher&quot; /&gt;&lt;/p&gt;</content><author><name></name></author><category term="rails" /></entry><entry><title type="html">Archiving CMS websites to static files with httrack</title><link href="https://larsp.de/webtech/archiving-cms-websites-to-static-files-with-httrack/" rel="alternate" type="text/html" title="Archiving CMS websites to static files with httrack" /><published>2022-08-19T00:00:00+02:00</published><updated>2022-08-19T00:00:00+02:00</updated><id>repo://posts.collection/_posts/2022-08-19-archiving-cms-websites-to-static-files-with-httrack.md</id><content type="html" xml:base="https://larsp.de/webtech/archiving-cms-websites-to-static-files-with-httrack/">&lt;p&gt;When a website made with a content management system like Drupal or Wordpress is no longer updated with content or a campaign has ended, sometimes the webpages need to be archived for reference or just stay online without any more changes. But it’s not always possible to upgrade all of the CMS along the way. Maybe there’s a major version change and it’s not economically reasonable to upgrade the custom modules for a site no longer in production use.&lt;/p&gt;

&lt;p&gt;That’s why it’s convenient to know how to easily archive a site to static HTML files.&lt;/p&gt;

&lt;h2 id=&quot;using-the-httrack-tool-to-archive-a-website&quot;&gt;Using the httrack tool to archive a website&lt;/h2&gt;

&lt;p&gt;There are quite some options for archiving a website (see &lt;a href=&quot;https://github.com/iipc/awesome-web-archiving&quot;&gt;Awesome Web Archiving List&lt;/a&gt;). I prefer using the &lt;a href=&quot;https://www.httrack.com&quot;&gt;httrack&lt;/a&gt; command line tool. On MacOS using Homebrew install it simply with:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;brew install httrack
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;These seem optimal httrack options for mirroring:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;httrack http://SITE_TO_ARCHIVE &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; DESTINATION_DIR &lt;span class=&quot;nt&quot;&gt;-N&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;%h%p/%n/index%[page].%t&quot;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;-WqQ&lt;/span&gt;%v &lt;span class=&quot;nt&quot;&gt;--robots&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0 &lt;span class=&quot;nt&quot;&gt;--footer&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The tool will prompt you if external links should be followed.&lt;/p&gt;

&lt;p&gt;If you like, relative links can also be rewritten afterwards e.g. “about.html” to “about”. This is optional but useful if you want to preserve the URL paths (for inbound links).&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;find &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-name&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;*.html&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; f &lt;span class=&quot;nt&quot;&gt;-print0&lt;/span&gt; | xargs &lt;span class=&quot;nt&quot;&gt;-0&lt;/span&gt; perl &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-pe&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s/&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;index.html/&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/g&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Copy the homepage index index/index.html to the site root and change include paths and links in it (remove “../” everywhere).&lt;/p&gt;

&lt;p&gt;If the source site uses HTTP authentication, provide username and password as part of the URL: username:password@your.url&lt;/p&gt;

&lt;p&gt;The resulting files can be served from some inexpensive static web hosting like Netlify or Github Pages.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.httrack.com/html/fcguide.html&quot;&gt;Httrack users guide&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.drupal.org/node/27882&quot;&gt;Archiving Drupal sites&lt;/a&gt; on drupal.org.&lt;/li&gt;
  &lt;li&gt;Karen from Lullabot &lt;a href=&quot;https://www.lullabot.com/articles/sending-drupal-site-retirement-using-httrack&quot;&gt;about archiving Drupal sites&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="webtech" /></entry><entry><title type="html">Ruby on Rails with Docker</title><link href="https://larsp.de/rails/ruby-on-rails-docker-production/" rel="alternate" type="text/html" title="Ruby on Rails with Docker" /><published>2022-07-12T00:00:00+02:00</published><updated>2022-07-12T00:00:00+02:00</updated><id>repo://posts.collection/_posts/2022-07-12-ruby-on-rails-docker-production.md</id><content type="html" xml:base="https://larsp.de/rails/ruby-on-rails-docker-production/">&lt;p&gt;Docker is a fantastic tool that allows developers to create and deploy applications in a consistent and predictable way. It offers the ability to create clean separations between different applications, ensuring that developers can work on multiple projects without worrying about conflicting dependencies or software versions. Additionally, Docker provides a way to define specific versions of software and runtime environments, which ensures that the application runs consistently across different environments. This is particularly useful for testing and deployment, as it allows developers to replicate the environment across different platforms, making it easy to deploy the application to production without any surprises.&lt;/p&gt;

&lt;h3 id=&quot;dokku&quot;&gt;Dokku&lt;/h3&gt;

&lt;p&gt;Today we are lucky to have several nice options for containerized Rails deployment. Personally, I like the &lt;a href=&quot;https://dokku.com/&quot;&gt;Dokku&lt;/a&gt; hosting system. Think of Dokku as a mini-Heroku; it’s lightweight but certainly packs a punch in terms of functionality. Multi-host deployments are not (easily) possible with Dokku.&lt;/p&gt;

&lt;h3 id=&quot;kamal&quot;&gt;Kamal&lt;/h3&gt;

&lt;p&gt;Developed by the Basecamp team and used for their Rails deployments (i.e. the HEY email service), this is a great option for multi-host setups. Imagine &lt;a href=&quot;https://kamal-deploy.org/&quot;&gt;Kamal&lt;/a&gt; as Capistrano for Containers, it will provision your servers and deploy the software to it, including the right version of Ruby and other dependencies. That all lives in the Docker image now. You can boot a brand new Ubuntu (or whatever) server, add it to the list of servers in MRSK, and it’ll be auto-provisioned with Docker, ready to run.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Kamal offers zero-downtime deploys, rolling restarts, asset bridging, remote builds, accessory service management, and everything else you need to deploy and manage your web app in production with Docker. Originally built for Rails apps, Kamal will work with any type of web app that can be containerized.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/images/venti-views-1cqIcrWFQBI-unsplash.jpg&quot; alt=&quot;Container ship&quot; /&gt;
&lt;em&gt;Photo by &lt;a href=&quot;https://unsplash.com/@ventiviews?utm_source=unsplash&amp;amp;utm_medium=referral&amp;amp;utm_content=creditCopyText&quot;&gt;Venti Views&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&quot;dockerfile&quot;&gt;Dockerfile&lt;/h3&gt;

&lt;p&gt;Since 7.1 Rails comes with a default Dockerfile, which is a good starting point for your own:&lt;/p&gt;

&lt;div class=&quot;language-docker highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# syntax = docker/dockerfile:1&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Make sure RUBY_VERSION matches the Ruby version in .ruby-version and Gemfile&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ARG&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; RUBY_VERSION=3.3.0&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;registry.docker.com/library/ruby:$RUBY_VERSION-slim&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;base&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Rails app lives here&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;WORKDIR&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; /rails&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Set production environment&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ENV&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; RAILS_ENV=&quot;production&quot; \&lt;/span&gt;
    BUNDLE_DEPLOYMENT=&quot;1&quot; \
    BUNDLE_PATH=&quot;/usr/local/bundle&quot; \
    BUNDLE_WITHOUT=&quot;development&quot;

# Throw-away build stage to reduce size of final image
&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;build&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Install packages needed to build gems and node modules&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;apt-get update &lt;span class=&quot;nt&quot;&gt;-qq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\
&lt;/span&gt;    apt-get &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--no-install-recommends&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; build-essential curl git libvips node-gyp pkg-config python-is-python3

&lt;span class=&quot;c&quot;&gt;# Install JavaScript dependencies&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ARG&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; NODE_VERSION=20.11.0&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ARG&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; YARN_VERSION=1.22.21&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ENV&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; PATH=/usr/local/node/bin:$PATH&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-sL&lt;/span&gt; https://github.com/nodenv/node-build/archive/master.tar.gz | &lt;span class=&quot;nb&quot;&gt;tar &lt;/span&gt;xz &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; /tmp/ &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\
&lt;/span&gt;    /tmp/node-build-master/bin/node-build &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;NODE_VERSION&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; /usr/local/node &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\
&lt;/span&gt;    npm &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; yarn@&lt;span class=&quot;nv&quot;&gt;$YARN_VERSION&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\
&lt;/span&gt;    &lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-rf&lt;/span&gt; /tmp/node-build-master

&lt;span class=&quot;c&quot;&gt;# Install application gems&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; Gemfile Gemfile.lock ./&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;bundle &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\
&lt;/span&gt;    &lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-rf&lt;/span&gt; ~/.bundle/ &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BUNDLE_PATH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;/ruby/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/cache &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BUNDLE_PATH&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;/ruby/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/bundler/gems/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;/.git &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\
&lt;/span&gt;    bundle &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;bootsnap precompile &lt;span class=&quot;nt&quot;&gt;--gemfile&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Install node modules&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; package.json yarn.lock ./&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;yarn &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--frozen-lockfile&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Copy application code&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; . .&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Precompile bootsnap code for faster boot times&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;bundle &lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;bootsnap precompile app/ lib/

&lt;span class=&quot;c&quot;&gt;# Precompiling assets for production without requiring secret RAILS_MASTER_KEY&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SECRET_KEY_BASE_DUMMY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 ./bin/rails assets:precompile

&lt;span class=&quot;c&quot;&gt;# Final stage for app image&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; base&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Install packages needed for deployment&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;apt-get update &lt;span class=&quot;nt&quot;&gt;-qq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\
&lt;/span&gt;    apt-get &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--no-install-recommends&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; curl libsqlite3-0 libvips &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\
&lt;/span&gt;    &lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-rf&lt;/span&gt; /var/lib/apt/lists /var/cache/apt/archives

&lt;span class=&quot;c&quot;&gt;# Copy built artifacts: gems, application&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; --from=build /usr/local/bundle /usr/local/bundle&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;COPY&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; --from=build /rails /rails&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Run and own only the runtime files as a non-root user for security&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;useradd rails &lt;span class=&quot;nt&quot;&gt;--create-home&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--shell&lt;/span&gt; /bin/bash &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\
&lt;/span&gt;    &lt;span class=&quot;nb&quot;&gt;chown&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; rails:rails db log storage tmp
&lt;span class=&quot;k&quot;&gt;USER&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; rails:rails&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Entrypoint prepares the database.&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ENTRYPOINT&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; [&quot;/rails/bin/docker-entrypoint&quot;]&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Start the server by default, this can be overwritten at runtime&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;EXPOSE&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; 3000&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;CMD&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; [&quot;./bin/rails&quot;, &quot;server&quot;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Extend with a GitHub action to build on commit (similar to &lt;a href=&quot;/webtech/bridgetown/&quot;&gt;autobuilding this Bridgetown site&lt;/a&gt;) and push the image to a repository like Docker Hub or Amazon ECR.&lt;/p&gt;

&lt;p&gt;Combine with nginx or &lt;a href=&quot;https://github.com/traefik/traefik/&quot;&gt;Traefik&lt;/a&gt; as load balancer/reverse proxy (or use Kamal or Dokku).&lt;/p&gt;

&lt;p&gt;Using nginx an additional certbot container is needed to generate and renew Letsencrypt TLS certificates. Traefik will handle this by itself.&lt;/p&gt;

&lt;p&gt;Another great option is to use the great &lt;a href=&quot;https://fly.io/&quot;&gt;fly.io&lt;/a&gt; service, which runs your Docker image on &lt;a href=&quot;https://firecracker-microvm.github.io/&quot;&gt;Firecracker&lt;/a&gt; microVMs on their global infrastructure.&lt;/p&gt;</content><author><name></name></author><category term="rails" /></entry><entry><title type="html">Bridgetown with GitHub Pages and custom domain</title><link href="https://larsp.de/webtech/bridgetown/" rel="alternate" type="text/html" title="Bridgetown with GitHub Pages and custom domain" /><published>2022-04-30T00:00:00+02:00</published><updated>2022-04-30T00:00:00+02:00</updated><id>repo://posts.collection/_posts/2022-04-30-bridgetown.md</id><content type="html" xml:base="https://larsp.de/webtech/bridgetown/">&lt;p&gt;For this personal website, I wanted to keep it lean and minimal and the blogging software or CMS should stay out of the way. It shouldn’t be a hassle to maintain or update. So in 2022 I started this site with the &lt;a href=&quot;https://www.bridgetownrb.com/&quot;&gt;Bridgetown&lt;/a&gt; static site generator. And so far, it’s going well.&lt;/p&gt;

&lt;p&gt;Having become quite an avid fan of Ruby in my recent developer years, a Ruby-powered static site generator seems a good fit. Bridgetown stands on the shoulders of &lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt;, which became immensely popular through Github Pages.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;em&gt;“Like the Ruby language itself, Bridgetown is optimized for web developer happiness.”&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;There is an undeniable appeal to static websites. Fast and simple, solid and staying as they are, without surprises (usually).&lt;/p&gt;

&lt;h2 id=&quot;build-and-deploy-on-github&quot;&gt;Build and deploy on Github&lt;/h2&gt;

&lt;p&gt;Thanks to &lt;a href=&quot;https://ruby.social/@andrewmcodes/&quot;&gt;@andrewmcodes&lt;/a&gt; for the writeup on &lt;a href=&quot;https://andrewm.codes/deploy-bridgetown-to-github-pages/&quot;&gt;how to setup the Bridgetown Github Pages plugin&lt;/a&gt; to automatically publish a site when pushing new content.&lt;/p&gt;

&lt;p&gt;I noticed that in order to get the deployment working with a custom domain the &lt;em&gt;cname&lt;/em&gt; setting has to be included in the workflow file:&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# .github/workflows/gh-pages.yml (Deploy section)&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Deploy&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;peaceiris/actions-gh-pages@v3&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;github_token&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;${{ secrets.GITHUB_TOKEN }}&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;publish_dir&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;./output&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;cname&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;larsp.de&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To prevent the auto reload script from being included in the deployed code I also changed the build environment in the Rakefile to &lt;em&gt;production&lt;/em&gt;:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# Rakefile&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Build the Bridgetown site for deployment&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;task&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:deploy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:clean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;frontend:build&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;no&quot;&gt;ENV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;BRIDGETOWN_ENV&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;production&quot;&lt;/span&gt;
  &lt;span class=&quot;no&quot;&gt;Bridgetown&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Commands&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Build&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;start&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;View this site’s source on &lt;a href=&quot;https://github.com/lape/larsp-website/&quot;&gt;Github&lt;/a&gt;.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.bridgetownrb.com/&quot;&gt;Bridgetown&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/bridgetownrb/bridgetown/&quot;&gt;Bridgetown’s Github repo&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://andrewm.codes/deploy-bridgetown-to-github-pages/&quot;&gt;How to Deploy Your Bridgetown Site to Github Pages — andrewm.codes&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="webtech" /></entry></feed>